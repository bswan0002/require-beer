<h1><%= @post.title %></h1>

<h2>
  by <%= @post.user.email %>
</h2>

<p>
  <%= @post.content %>
</p>

<% if admin? %>
  <%= link_to 'Edit', edit_post_path(@post) %> |
<% end %>

<%= link_to 'Back', posts_path %>

<% if user_signed_in? %>
  <% if @post.liked?(current_user) %>
    <%= button_to "Unlike", unlike_path(@post), method: "delete" %>
  <% else %>
    <%= button_to "Like", like_path(@post), method: "put" %>
  <% end %>
  <%= form_for([@post, @post.comments.build]) do |f| %>

    <% if @comment && @comment.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(@comment.errors.count, "error") %> prohibited this post from being saved:</h2>

        <ul>
          <% @comment.errors.each do |error| %>
            <li><%= error.full_message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="field">
      <%= f.label "comment:" %><br />
      <%= f.text_area :body %>
    </div>
    <div class="actions">
      <%= f.submit "Comment" %>
    </div>
  <% end %>
<% end %><br>



<h3>Comments</h3>
<% @comments.each do |comment| %>
  <% if comment.user %>
    <%= "#{comment.user.email}: #{comment.body}" %><br>
  <% end %>
<% end %>
